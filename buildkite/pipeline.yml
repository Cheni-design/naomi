steps:
  - label: ":whale: Build"
    command: docker/build

  - wait

  - label: ":hammer: Test"
    command: docker/test

  - wait

  - label: ":shipit: Push images"
    command: docker/push

  - wait

  # The next step triggers a build on the hintr:
  # https://buildkite.com/docs/pipelines/trigger-step
  #
  # This triggers on every hint build so that we can check that the
  # changes work with hintr, and pass the naomi sha through an
  # environment variable.  The build is against hintr master
  - trigger: "hintr"
    label: ":rocket: hintr (from naomi) :docker:"
    build:
      # branch: master # TODO <- set this one back once hintr merged
      branch: mrc-1471
      env:
        NAOMI_SHA: "${BUILDKITE_COMMIT}"
